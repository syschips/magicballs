# MagicBall(仮)

## 概要
ブラウザで動く、１画面で収まる対戦型アーケードゲームを作ろう

+ プレーヤーは、自分の足元からボールを発射できる
+ ボールはプレーヤーの向いている方向に直進し、一定期間で爆発する
+ 爆発は十字型に広がり、壁を壊せる
+ 爆発はボールの中心から外側に広がる
+ プレーヤーの足元で爆発したらゲームオーバー
+ プレーヤーが最後の一人になるまで続ける
+ ボールの爆発で壊せる壁にはアイテムがある場合がある。
+ アイテムの種類は以下の通り
    - 設置したボールのフィールド上に存在できる上限数＋１
    - 爆発時の火力の範囲＋１
    - プレーヤーの移動速度アップ

## ファイル構成
```
src/
├── constants.js    - 定数定義(フィールドサイズ、ゲームバランス設定)
├── state.js        - ゲーム状態管理(グローバル変数とリセット処理)
├── utils.js        - ユーティリティ関数(座標判定、効果音)
├── map.js          - マップ初期化と生成
├── player.js       - プレイヤー関連(生成、移動制御、入力処理)
├── ball.js         - ボール関連(発射、移動、爆発処理)
├── ai.js           - AI制御ロジック(危険判定、移動選択)
├── renderer.js     - 描画処理(Canvas描画)
├── input.js        - 入力処理(キーボード、マウス、UI)
└── main.js         - メインループと統合
```
## 各ファイルの役割

### constants.js
- フィールドサイズ定数
- ゲームバランス調整用の数値定義
- AI動作パラメータ

### state.js
- 全ゲームエンティティの状態管理
- マップ、ボール、アイテム、プレイヤーなどの配列
- キー入力状態、キーバインド設定

### utils.js
- 座標判定関数 (inBounds, cellAt, ballExists)
- 効果音再生機能

### map.js
- マップ初期化ロジック
- 壁と箱の配置アルゴリズム

### player.js
- プレイヤーオブジェクト生成
- 移動制御(グリッドスナップ、衝突判定)
- キー入力からの移動方向計算
- アイテム取得処理

### ball.js
- ボール発射処理
- ボール移動と衝突判定
- 爆発スケジューリングと連鎖反応
- プレビュー表示
- アイテムドロップ

### ai.js
- 危険エリア計算(爆発予測範囲)
- AI行動ロジック(回避、攻撃判定)
- 緊急回避動作

### renderer.js
- Canvas描画処理
- マップ、プレイヤー、ボール、エフェクトの描画
- UI表示

### input.js
- キーボード入力セットアップ
- マウスクリック処理
- UIボタン・チェックボックスのイベント処理

### main.js
- ゲームループ制御
- 各モジュールの統合
- ゲームリセット・勝敗判定

## Todo
・このコードに「複数種類のボール」「AI」「オンライン（WebSocket）対戦」などを追加する。


## Test
https://syschips.github.io/magicballs/